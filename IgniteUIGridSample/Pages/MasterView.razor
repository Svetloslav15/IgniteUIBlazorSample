@page "/"
@using IgniteUIGridSample.Models;
@inject Northwind.IDataSourceService northwindService

<div class="row-layout master-view-container">
    @if (employees.Count > 0 && countries.Count > 0)
    {
        <IgbGrid Height="800px" Data="employees" PrimaryKey="EmployeeID" DisplayDensity="DisplayDensity.Cosy" class="ig-typography grid" master-view-scope>
            <IgbColumn Field="EmployeeID" DataType="GridColumnDataType.Number" Header="employeeID"/>
            <IgbColumn Field="FirstName" DataType="GridColumnDataType.String" Header="FirstName" />
            <IgbColumn Field="LastName" DataType="GridColumnDataType.String" Header="LastName" />

            <IgbColumn Header="Country" BodyTemplate="MultiColumnComboBoxTemplate" />
            <IgbColumn Header="Department" BodyTemplate="DropDownTemplate" />
        </IgbGrid>
    }
</div>

@code {
    private static List<Employee> employees = new List<Employee>();
    private static List<Country> countries = new List<Country>();
    private static string[] displayFields = new string[] { "Name", "Code" };
    private static List<string> departments = new List<string> { "Engineering", "Marketing", "HR"};

    protected override async Task OnInitializedAsync()
    {
        employees = await this.northwindService.GetEmployees() ?? employees;
        countries = await this.northwindService.GetCountries() ?? countries;
    }

    public RenderFragment<IgbCellTemplateContext> MultiColumnComboBoxTemplate = (ctx) =>
    {
        return
            @<IgbMultiColumnComboBox DataSource="countries"
                Fields="displayFields"
                TextField="Name"
                Placeholder="Choose a country"/>;
    };

    public RenderFragment<IgbCellTemplateContext> DropDownTemplate = (ctx) =>
    {
        return
            @<IgbDropdown>
            <IgbButton slot="target">Department</IgbButton>
                @foreach (var department in departments)
                {
                    <IgbDropdownItem>@department</IgbDropdownItem>
                }
            </IgbDropdown>;
    };
};